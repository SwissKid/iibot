#!/bin/bash
channel=$@
owner="swiss"
nick="swissboxbot"
server="irc.freenode.net"
ircdir="/home/swiss/testing"
iidir="/home/swiss/iibot"
touch "$ircdir/$server/$channel/out"
joined=true
tailf -n1 "$ircdir/$server/$channel/out" |\
 while read -r date time nick msg; do
	set -- $msg
	start=$1
	shift
	rest=$@
	command=$(echo $start | sed -e "s/^!//")
	truenick=$(echo $nick | sed -e "s/^<//" -e "s/>$//")

joined=$(tail -n1 in$channel)
if [ "$joined" == "false" ]; then
	exit 0
fi
if [[ "$msg" == swissboxbot:* ]]; then
	./scripts/saymyname $channel $truenick $msg
fi


##Name recognition thing ain't workin
#	if [ "$(echo $msg | head -c 12)" == 'swissboxbot:' ]; then
#		text=$(echo $msg | sed -e "s/swissboxbox: //")
#		if [ "$( echo $text | head -c 8 | tr '[A-Z]' '[a-z]')" == 'fuck you' ]; then
#			echo "You'd like to, wouldn't you?!"
#		fi 
#	fi

#	if [ "$(echo $msg | head -c 1)" == '!' ]; then
#	##Send the commands to the scripts!
#		./scripts/command $truenick $command $rest
#	fi
done
